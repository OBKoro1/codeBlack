<!--
 * Author       : OBKoro1
 * Date         : 2020-04-15 17:21:59
 * LastEditors  : OBKoro1
 * LastEditTime : 2020-04-15 17:24:26
 * FilePath     : /codeBlack/template.html
 * Description  : 93复原IP地址
 * https://github.com/OBKoro1
 -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>93复原IP地址</title>
  </head>
  <body>
    <script>
      const oldS = '25525511135'
      // 输出: ["255.255.11.135", "255.255.111.35"]
      // 回溯
      var restoreIpAddresses = function (s) {
        if (s.length > 12) return []
        let result = []
        fn(s, [], result)
        return result
      }
      // 递归
      function fn(remain, temp, result) {
        // 第四段
        if (temp.length === 3) {
          if (regular(remain)) {
          // 合法即为正确的值
            result.push([...temp, remain].join('.'))
          }
          return
        }
        // 每段长度都可能为1/2/3
        for (let i = 1; i < 4; i++) {
          // 合法才可继续
          if (regular(remain.substr(0, i))) {
            const strArr = [...temp, remain.substr(0, i)] // 字符段
            const str = remain.substr(i) // 剩下的字符串
            fn(str, strArr, result)
          }
        }
      }
      // 验证合法性
      function regular(s) {
        if (!s.length) return false
        return 0 <= +s && +s <= 255 && (s.length > 1 ? !!+s[0] : true)
      }

      // 暴力回溯
      /**
       * @param {string} s
       * @return {string[]}
       */
      var restoreIpAddresses = function (s) {
        let res = []
        function helper(str, last, len) {
          if (len === 3) {
            // 验证合法性
            if (str.length <= 3 && parseInt(str.slice(0, 3)) <= 255) {
              if (str.length >= 2 && str.charAt(0) === '0') {
                return
              }
              const item = last.concat(str) // 添加到结果
              res.push(item)
              return
            }
          }
          // 可以写成循环 但是没必要 用上面那个方法就可以 
          if (len < 3) {
            // 切割一个字符
            let item = last.concat(str.slice(0, 1).concat('.'))
            // 重复提取字符的操作
            helper(str.slice(1), item, len + 1)
            // 如果不行的话 退回item 进行切割两个/三个字符的操作
            if (str.charAt(0) !== '0') {
              // 切割两个字符
              item = last.concat(str.slice(0, 2)).concat('.')
              helper(str.slice(2), item, len + 1)
              if (parseInt(str.slice(0, 3)) <= 255) {
                // 切割三个字符
                item = last.concat(str.slice(0, 3)).concat('.')
                helper(str.slice(3), item, len + 1)
              }
            }
          }
        }
        helper(s, '', 0)
        return res
      }
      console.log('输出', restoreIpAddresses(oldS))
    </script>
  </body>
</html>
